<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pools Explorer - DeFi Portfolio</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <header class="sticky-header">
        <nav class="container">
            <div class="nav-brand">
                <h1 class="logo">DeFi Portfolio</h1>
            </div>
            <ul class="nav-links">
                <li><a href="crypto-example.html">Home</a></li>
                <li><a href="dashboard.html">Dashboard</a></li>
                <li><a href="pools.html" class="active">Pools</a></li>
                <li><a href="crypto-example.html#faq">FAQ</a></li>
            </ul>
        </nav>
    </header>

    <main class="pools-main">
        <div class="container">
            <div class="pools-header">
                <h1 class="pools-title">Explore Liquidity Pools</h1>
                <p class="pools-subtitle">Discover the best yield opportunities across multiple protocols</p>
            </div>

            <!-- Pool Filters and Search -->
            <div class="pools-controls">
                <div class="search-container">
                    <input type="text" id="poolSearch" placeholder="Search pools by name, token, or protocol..." class="pool-search-input">
                    <span class="search-icon">üîç</span>
                </div>
                
                <div class="pool-filters">
                    <div class="filter-group">
                        <label class="filter-label">Protocol:</label>
                        <select id="protocolFilter" class="filter-select">
                            <option value="all">All Protocols</option>
                            <option value="aave">Aave</option>
                            <option value="compound">Compound</option>
                            <option value="curve">Curve</option>
                            <option value="uniswap">Uniswap</option>
                            <option value="sushiswap">SushiSwap</option>
                            <option value="balancer">Balancer</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Min APR:</label>
                        <select id="aprFilter" class="filter-select">
                            <option value="0">0%+</option>
                            <option value="5">5%+</option>
                            <option value="10">10%+</option>
                            <option value="20">20%+</option>
                            <option value="50">50%+</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">Sort by:</label>
                        <select id="sortFilter" class="filter-select">
                            <option value="tvl">TVL (High to Low)</option>
                            <option value="apr">APR (High to Low)</option>
                            <option value="volume">Volume (24h)</option>
                            <option value="name">Name (A-Z)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Pool Stats Overview -->
            <div class="pool-stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üí∞</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalTVL">$127.8M</div>
                        <div class="stat-label">Total TVL</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">üìä</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalPools">42</div>
                        <div class="stat-label">Active Pools</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-content">
                        <div class="stat-value" id="avgAPR">18.4%</div>
                        <div class="stat-label">Avg APR</div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">üîÑ</div>
                    <div class="stat-content">
                        <div class="stat-value" id="totalVolume">$24.6M</div>
                        <div class="stat-label">24h Volume</div>
                    </div>
                </div>
            </div>

            <!-- Pools Grid -->
            <div class="pools-grid" id="poolsGrid">
                <!-- Pool cards will be dynamically inserted here -->
            </div>

            <!-- Load More Button -->
            <div class="load-more-container">
                <button id="loadMorePools" class="btn btn-secondary">Load More Pools</button>
            </div>

            <!-- Pool Analytics Chart -->
            <div class="pool-analytics">
                <h2 class="section-title">Pool Analytics</h2>
                <div class="chart-container">
                    <div class="chart-card">
                        <h3>TVL Distribution by Protocol</h3>
                        <canvas id="tvlChart" width="400" height="200"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>APR vs TVL Scatter Plot</h3>
                        <canvas id="aprTvlChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>DeFi Portfolio</h4>
                    <p>Built with ‚ù§Ô∏è for the blockchain community</p>
                </div>
                <div class="footer-section">
                    <h4>Links</h4>
                    <ul>
                        <li><a href="#" aria-label="GitHub">GitHub</a></li>
                        <li><a href="#" aria-label="Discord">Discord</a></li>
                        <li><a href="#" aria-label="Twitter">Twitter</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="#" aria-label="Documentation">Docs</a></li>
                        <li><a href="#" aria-label="Security Audits">Security</a></li>
                        <li><a href="#" aria-label="Support">Support</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 DeFi Portfolio. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // Mock pool data
        const poolData = [
            {
                id: 1,
                name: 'USDC/ETH',
                protocol: 'uniswap',
                tvl: 45200000,
                apr: 24.5,
                volume24h: 8500000,
                tokens: ['USDC', 'ETH'],
                risk: 'Low',
                category: 'Stablecoin',
                protocolLogo: 'ü¶Ñ'
            },
            {
                id: 2,
                name: 'DAI/USDC',
                protocol: 'curve',
                tvl: 32100000,
                apr: 18.2,
                volume24h: 4200000,
                tokens: ['DAI', 'USDC'],
                risk: 'Very Low',
                category: 'Stablecoin',
                protocolLogo: 'üåä'
            },
            {
                id: 3,
                name: 'WBTC/ETH',
                protocol: 'sushiswap',
                tvl: 28900000,
                apr: 32.1,
                volume24h: 6700000,
                tokens: ['WBTC', 'ETH'],
                risk: 'Medium',
                category: 'Volatile',
                protocolLogo: 'üç£'
            },
            {
                id: 4,
                name: 'USDT/USDC',
                protocol: 'curve',
                tvl: 21600000,
                apr: 15.8,
                volume24h: 3100000,
                tokens: ['USDT', 'USDC'],
                risk: 'Very Low',
                category: 'Stablecoin',
                protocolLogo: 'üåä'
            },
            {
                id: 5,
                name: 'ETH/DAI',
                protocol: 'balancer',
                tvl: 19300000,
                apr: 26.7,
                volume24h: 2800000,
                tokens: ['ETH', 'DAI'],
                risk: 'Medium',
                category: 'Volatile',
                protocolLogo: '‚öñÔ∏è'
            },
            {
                id: 6,
                name: 'MATIC/ETH',
                protocol: 'uniswap',
                tvl: 15700000,
                apr: 42.3,
                volume24h: 1900000,
                tokens: ['MATIC', 'ETH'],
                risk: 'High',
                category: 'Volatile',
                protocolLogo: 'ü¶Ñ'
            }
        ];

        let filteredPools = [...poolData];
        let displayedPools = 6;

        // Initialize pools page
        document.addEventListener('DOMContentLoaded', () => {
            renderPools();
            setupEventListeners();
            renderCharts();
            updateStats();
        });

        function renderPools() {
            const poolsGrid = document.getElementById('poolsGrid');
            const poolsToShow = filteredPools.slice(0, displayedPools);
            
            poolsGrid.innerHTML = poolsToShow.map(pool => `
                <div class="pool-card" data-pool-id="${pool.id}">
                    <div class="pool-header">
                        <div class="pool-tokens">
                            <div class="token-icons">
                                ${pool.tokens.map(token => `<span class="token-icon">${getTokenIcon(token)}</span>`).join('')}
                            </div>
                            <div class="pool-info">
                                <h3 class="pool-name">${pool.name}</h3>
                                <div class="pool-protocol">
                                    <span class="protocol-logo">${pool.protocolLogo}</span>
                                    <span class="protocol-name">${pool.protocol.charAt(0).toUpperCase() + pool.protocol.slice(1)}</span>
                                </div>
                            </div>
                        </div>
                        <div class="pool-risk">
                            <span class="risk-badge ${pool.risk.toLowerCase().replace(' ', '-')}">${pool.risk}</span>
                        </div>
                    </div>
                    
                    <div class="pool-metrics">
                        <div class="metric">
                            <div class="metric-label">TVL</div>
                            <div class="metric-value">$${formatNumber(pool.tvl)}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">APR</div>
                            <div class="metric-value apr-value">${pool.apr}%</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">24h Volume</div>
                            <div class="metric-value">$${formatNumber(pool.volume24h)}</div>
                        </div>
                    </div>
                    
                    <div class="pool-actions">
                        <button class="btn btn-primary pool-action-btn" onclick="viewPool(${pool.id})">
                            View Details
                        </button>
                        <button class="btn btn-secondary pool-action-btn" onclick="addLiquidity(${pool.id})">
                            Add Liquidity
                        </button>
                    </div>
                </div>
            `).join('');
            
            // Update load more button visibility
            const loadMoreBtn = document.getElementById('loadMorePools');
            loadMoreBtn.style.display = displayedPools >= filteredPools.length ? 'none' : 'block';
        }

        function getTokenIcon(token) {
            const icons = {
                'USDC': 'üí∞',
                'ETH': 'Œû',
                'DAI': 'ü™ô',
                'USDT': 'üíé',
                'WBTC': '‚Çø',
                'MATIC': 'üü£'
            };
            return icons[token] || 'üîò';
        }

        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function setupEventListeners() {
            // Search functionality
            document.getElementById('poolSearch').addEventListener('input', handleSearch);
            
            // Filter functionality
            document.getElementById('protocolFilter').addEventListener('change', handleFilters);
            document.getElementById('aprFilter').addEventListener('change', handleFilters);
            document.getElementById('sortFilter').addEventListener('change', handleFilters);
            
            // Load more functionality
            document.getElementById('loadMorePools').addEventListener('click', () => {
                displayedPools += 6;
                renderPools();
            });
        }

        function handleSearch(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            if (searchTerm === '') {
                filteredPools = [...poolData];
            } else {
                filteredPools = poolData.filter(pool => 
                    pool.name.toLowerCase().includes(searchTerm) ||
                    pool.protocol.toLowerCase().includes(searchTerm) ||
                    pool.tokens.some(token => token.toLowerCase().includes(searchTerm))
                );
            }
            
            displayedPools = 6;
            renderPools();
            updateStats();
        }

        function handleFilters() {
            const protocol = document.getElementById('protocolFilter').value;
            const minApr = parseFloat(document.getElementById('aprFilter').value);
            const sortBy = document.getElementById('sortFilter').value;
            
            // Apply filters
            filteredPools = poolData.filter(pool => {
                const protocolMatch = protocol === 'all' || pool.protocol === protocol;
                const aprMatch = pool.apr >= minApr;
                return protocolMatch && aprMatch;
            });
            
            // Apply sorting
            filteredPools.sort((a, b) => {
                switch (sortBy) {
                    case 'tvl':
                        return b.tvl - a.tvl;
                    case 'apr':
                        return b.apr - a.apr;
                    case 'volume':
                        return b.volume24h - a.volume24h;
                    case 'name':
                        return a.name.localeCompare(b.name);
                    default:
                        return 0;
                }
            });
            
            displayedPools = 6;
            renderPools();
            updateStats();
        }

        function updateStats() {
            const totalTVL = filteredPools.reduce((sum, pool) => sum + pool.tvl, 0);
            const avgAPR = filteredPools.reduce((sum, pool) => sum + pool.apr, 0) / filteredPools.length;
            const totalVolume = filteredPools.reduce((sum, pool) => sum + pool.volume24h, 0);
            
            document.getElementById('totalTVL').textContent = '$' + formatNumber(totalTVL);
            document.getElementById('totalPools').textContent = filteredPools.length;
            document.getElementById('avgAPR').textContent = avgAPR.toFixed(1) + '%';
            document.getElementById('totalVolume').textContent = '$' + formatNumber(totalVolume);
        }

        function renderCharts() {
            // TVL Distribution Chart
            const tvlCtx = document.getElementById('tvlChart').getContext('2d');
            const protocolTVL = {};
            
            poolData.forEach(pool => {
                if (!protocolTVL[pool.protocol]) {
                    protocolTVL[pool.protocol] = 0;
                }
                protocolTVL[pool.protocol] += pool.tvl;
            });
            
            new Chart(tvlCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(protocolTVL).map(p => p.charAt(0).toUpperCase() + p.slice(1)),
                    datasets: [{
                        data: Object.values(protocolTVL),
                        backgroundColor: [
                            '#8A9A5B',
                            '#6B7A44',
                            '#9AAA6B',
                            '#A5B570',
                            '#7B8A54',
                            '#556B35'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#FFFFFF'
                            }
                        }
                    }
                }
            });
            
            // APR vs TVL Scatter Plot
            const scatterCtx = document.getElementById('aprTvlChart').getContext('2d');
            new Chart(scatterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Pools',
                        data: poolData.map(pool => ({
                            x: pool.tvl / 1000000, // Convert to millions for readability
                            y: pool.apr
                        })),
                        backgroundColor: '#8A9A5B',
                        borderColor: '#6B7A44'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#FFFFFF'
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'TVL (Millions $)',
                                color: '#FFFFFF'
                            },
                            ticks: {
                                color: '#FFFFFF'
                            },
                            grid: {
                                color: '#444444'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'APR (%)',
                                color: '#FFFFFF'
                            },
                            ticks: {
                                color: '#FFFFFF'
                            },
                            grid: {
                                color: '#444444'
                            }
                        }
                    }
                }
            });
        }

        function viewPool(poolId) {
            const pool = poolData.find(p => p.id === poolId);
            alert(`Viewing details for ${pool.name}\n\nTVL: $${formatNumber(pool.tvl)}\nAPR: ${pool.apr}%\nProtocol: ${pool.protocol}`);
        }

        function addLiquidity(poolId) {
            const pool = poolData.find(p => p.id === poolId);
            alert(`Adding liquidity to ${pool.name} pool\n\nThis would typically open a modal or redirect to the protocol's interface.`);
        }
    </script>
</body>
</html>
